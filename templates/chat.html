<!DOCTYPE html>
<html lang='ar' dir='rtl'>
<head>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<title>فراس | المساعد الذكي</title>

<style>
:root{
  --primary:#1976f2;
  --secondary:#42a5f5;
  --bg1:#0b1220;
  --bg2:#16233f;
  --card:#ffffff;
}

html,body{
  margin:0;
  height:100%;
  font-family:'Segoe UI',Arial;
  background:linear-gradient(160deg,var(--bg1),var(--bg2));
}

#app{
  max-width:420px;
  height:92vh;
  margin:4vh auto;
  background:var(--card);
  border-radius:20px;
  box-shadow:0 25px 50px rgba(0,0,0,.35);
  display:flex;
  flex-direction:column;
  overflow:hidden;
  transform:translateZ(0);
}

#header{
  background:linear-gradient(135deg,var(--primary),var(--secondary));
  color:#fff;
  padding:18px;
  text-align:center;
  font-size:18px;
  box-shadow:0 8px 18px rgba(0,0,0,.35);
}

#messages{
  flex:1;
  padding:16px;
  overflow-y:auto;
  background:#f4f6fb;
}

.msg{
  max-width:80%;
  margin-bottom:12px;
  padding:12px 14px;
  border-radius:18px;
  font-size:14px;
  line-height:1.6;
  box-shadow:0 6px 14px rgba(0,0,0,.15);
}

.bot{
  background:#e3e8f0;
  color:#000;
}

.user{
  background:var(--primary);
  color:#fff;
  margin-left:auto;
}

#footer{
  display:flex;
  padding:12px;
  background:#fff;
  border-top:1px solid #e0e0e0;
}

#input{
  flex:1;
  border-radius:24px;
  border:1px solid #ccc;
  padding:12px 16px;
  font-size:14px;
}

#send{
  background:var(--primary);
  color:#fff;
  border:none;
  border-radius:24px;
  padding:12px 18px;
  margin-right:8px;
  cursor:pointer;
  box-shadow:0 6px 14px rgba(0,0,0,.25);
}

/* شاشة التسجيل المنبثقة */
#loginPanel{
  position:fixed;
  top:-100%;
  left:0;
  width:100%;
  height:100%;
  background:rgba(11,18,32,.85);
  display:flex;
  justify-content:center;
  transition:top .7s cubic-bezier(.4,0,.2,1);
  z-index:999;
}

#loginPanel.active{
  top:0;
}

#loginBox{
  margin-top:40px;
  width:90%;
  max-width:420px;
  background:#fff;
  border-radius:20px;
  padding:24px;
  box-shadow:0 25px 50px rgba(0,0,0,.45);
  transform:perspective(900px) rotateX(6deg);
}

#loginBox h3{
  margin:0 0 12px 0;
  text-align:center;
  color:var(--primary);
}

#loginBox input{
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:12px;
  border:1px solid #ccc;
  font-size:14px;
}

#loginBox button{
  width:100%;
  padding:14px;
  margin-top:16px;
  background:linear-gradient(135deg,var(--primary),var(--secondary));
  color:#fff;
  border:none;
  border-radius:14px;
  font-size:15px;
  cursor:pointer;
  box-shadow:0 10px 22px rgba(0,0,0,.35);
}
</style>
</head>

<body>

<div id='loginPanel' class='active'>
  <div id='loginBox'>
    <h3>تسجيل الدخول</h3>
    <input id='name' placeholder='الاسم الكامل'>
    <input id='email' placeholder='البريد الإلكتروني'>
    <input id='phone' placeholder='رقم الجوال'>
    <button onclick='loginUser()'>دخول</button>
  </div>
</div>

<div id='app'>
  <div id='header'>فراس – المساعد الذكي</div>

  <div id='messages'>
    <div class='msg bot'>
      السلام عليكم ورحمة الله وبركاته، معك المساعد الذكي فراس. كيف يمكنني خدمتك؟
    </div>
  </div>

  <div id='footer'>
    <button id='send' onclick='send()'>إرسال</button>
    <input id='input' placeholder='اكتب سؤالك هنا'>
  </div>
</div>

<script>
function loginUser(){
  if(!name.value || !email.value || !phone.value) return;
  fetch('/login',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      name:name.value,
      email:email.value,
      phone:phone.value
    })
  })
  .then(r=>r.json())
  .then(d=>{
    if(d.ok){
      document.getElementById('loginPanel').classList.remove('active');
    }
  });
}

const input=document.getElementById('input');
const messages=document.getElementById('messages');

input.addEventListener('keydown',e=>{
  if(e.key==='Enter') send();
});

function add(text,type){
  const d=document.createElement('div');
  d.className='msg '+type;
  d.innerText=text;
  messages.appendChild(d);
  messages.scrollTop=messages.scrollHeight;
}

function send(){
  if(!input.value) return;
  const q=input.value;
  add(q,'user');
  input.value='';
  fetch('/ask',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({message:q})
  })
  .then(r=>r.json())
  .then(d=>add(d.reply,'bot'));
}
</script>

</body>
</html>
