<!DOCTYPE html>
<html lang='ar' dir='rtl'>
<head>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<title>فراس | المساعد الذكي</title>
<style>
body{
  margin:0;
  font-family:'Segoe UI',Arial;
  background:linear-gradient(160deg,#0b1220,#16233f);
  height:100vh;
}
#app{
  max-width:420px;
  height:92vh;
  margin:4vh auto;
  background:#fff;
  border-radius:18px;
  box-shadow:0 20px 40px rgba(0,0,0,.35);
  display:flex;
  flex-direction:column;
  overflow:hidden;
}
#header{
  background:linear-gradient(135deg,#1976f2,#42a5f5);
  color:#fff;
  padding:16px;
  text-align:center;
}
#messages{
  flex:1;
  padding:14px;
  overflow-y:auto;
  background:#f4f6fb;
}
.msg{
  max-width:80%;
  margin-bottom:12px;
  padding:12px 14px;
  border-radius:16px;
}
.bot{background:#e3e8f0}
.user{
  background:#1976f2;
  color:#fff;
  margin-left:auto;
}
#footer{
  display:flex;
  padding:12px;
  border-top:1px solid #ddd;
}
#input{
  flex:1;
  border-radius:22px;
  border:1px solid #ccc;
  padding:12px;
}
#send{
  background:#1976f2;
  color:#fff;
  border:none;
  border-radius:22px;
  padding:12px 18px;
  margin-right:8px;
}

/* Login Panel */
#loginPanel{
  position:fixed;
  top:-100%;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,.75);
  display:flex;
  justify-content:center;
  transition:top .6s ease;
  z-index:999;
}
#loginPanel.active{top:0}
#loginBox{
  margin-top:40px;
  background:#fff;
  width:90%;
  max-width:420px;
  border-radius:18px;
  padding:22px;
  box-shadow:0 20px 40px rgba(0,0,0,.4);
}
#loginBox input,#loginBox button{
  width:100%;
  padding:12px;
  margin-top:10px;
}
#loginBox button{
  background:#1976f2;
  color:#fff;
  border:none;
  border-radius:12px;
}
</style>
</head>
<body>

<div id='loginPanel' class='active'>
  <div id='loginBox'>
    <h3 style='text-align:center'>تسجيل الدخول</h3>
    <input id='name' placeholder='الاسم'>
    <input id='email' placeholder='البريد الإلكتروني'>
    <input id='phone' placeholder='رقم الجوال'>
    <button onclick='login()'>دخول</button>
  </div>
</div>

<div id='app'>
  <div id='header'>فراس – المساعد الذكي</div>
  <div id='messages'>
    <div class='msg bot'>مرحباً، كيف أستطيع مساعدتك؟</div>
  </div>
  <div id='footer'>
    <button id='send' onclick='send()'>إرسال</button>
    <input id='input'>
  </div>
</div>

<script>
function login(){
  if(!name.value||!email.value||!phone.value)return
  fetch('/login',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      name:name.value,
      email:email.value,
      phone:phone.value
    })
  }).then(r=>r.json()).then(d=>{
    if(d.ok){
      document.getElementById('loginPanel').classList.remove('active')
    }
  })
}

const input=document.getElementById('input')
const messages=document.getElementById('messages')

input.addEventListener('keydown',e=>{if(e.key==='Enter')send()})

function add(t,c){
  const d=document.createElement('div')
  d.className='msg '+c
  d.innerText=t
  messages.appendChild(d)
  messages.scrollTop=messages.scrollHeight
}

function send(){
  if(!input.value)return
  const q=input.value
  add(q,'user')
  input.value=''
  fetch('/ask',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({message:q})
  }).then(r=>r.json()).then(d=>add(d.reply,'bot'))
}
</script>

</body>
</html>
